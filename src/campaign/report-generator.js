export function generateReport({ pipeline, projectSlug, stepResults, timestamp, campaignDir }) {
  const lines = []

  lines.push(`# Campaign Report: ${pipeline.name}`)
  lines.push('')
  lines.push(`> Project: ${projectSlug}`)
  lines.push(`> Pipeline: ${pipeline.name} (v${pipeline.version || 1})`)
  lines.push(`> Executed: ${timestamp}`)
  lines.push(`> Status: ${stepResults.every(r => r.status === 'completed') ? '✅ COMPLETED' : '❌ FAILED'}`)
  lines.push('')

  lines.push('## Steps')
  lines.push('')

  for (const result of stepResults) {
    const icon = result.status === 'completed' ? '✅' : '❌'
    lines.push(`### ${icon} ${result.stepName || result.stepId}`)
    lines.push(`- Squad: ${result.squad}`)
    if (result.agent) lines.push(`- Agent: ${result.agent}`)
    lines.push(`- Output type: ${result.outputType}`)
    lines.push(`- Status: ${result.status}`)

    if (result.output?.agents) {
      lines.push(`- Agents used: ${result.output.agents.join(' → ')}`)
    }

    if (result.error) {
      lines.push(`- Error: ${result.error}`)
    }
    lines.push('')
  }

  lines.push('## Summary')
  lines.push('')
  lines.push(`- Total steps: ${stepResults.length}`)
  lines.push(`- Completed: ${stepResults.filter(r => r.status === 'completed').length}`)
  lines.push(`- Failed: ${stepResults.filter(r => r.status === 'failed').length}`)
  lines.push('')
  lines.push('---')
  lines.push(`> Generated by NEXUS Campaign Engine`)
  lines.push(`> Campaign dir: ${campaignDir}`)

  return lines.join('\n')
}
